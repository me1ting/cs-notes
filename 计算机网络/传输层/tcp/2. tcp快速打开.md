# 背景知识

[TCP快速打开](https://tools.ietf.org/html/rfc7413)是Google为了满足Web对TCP的需求而针对TCP握手的提出的一种扩展，并得到了最新的操作系统和一些软件的支持。

但事实上虽然TFO已经被支持，但几乎所有的客户端都未启用该技术，因为它与现有的基础设施存在一定的兼容性问题。而HTTP3选择了UDP上自建可靠性协议，则意味着这项技术前景暗淡。

# Web的需求与TCP的不足

在HTTP1.0,HTTP2.0时代，HTTP工作在TCP协议之上，标准的TCP在可以通信前需要三次握手，也就意味着每次在新TCP连接上发起的请求存在固定的延迟。

# TFO的原理

TFO的基本原理是让同步(SYN)段,同步确认(SYN ACK)段就可以携带数据并被应用层使用，它借鉴了HTTP协议中cookie的思想：在首次连接时服务端创建TFO cookie并保存，第二次连接同步阶段携带TFO cookie以供服务器验证。

事实上标准TCP就已经允许SYN携带数据了，只是在握手完成前不能交付给应用层。因此TCP实现基本都是老老实实的进行三次握手以后再传递数据。

事实上标准TCP的第三次握手(ACK段)发送后，客户端就可以立即发送数据，因此使用TFO也只是节省一个RTT时间。

# 参考资料

https://www.keycdn.com/support/tcp-fast-open