# 快速排序

快速排序是一种实际应用中通常很快的算法，是目前使用最多的排序算法。

## 基本策略

快速排序的算法基础是`分治法`，采取递归实现。

基本策略是，选取一个合适的数作为`枢纽元`（或称为切分元），从左右两边向中间遍历数据，将左边大于枢纽元的数据与右边小于枢纽元的数据进行交换，直到左右相接。这样数据被分成两部分，左边是小于枢纽元的，右边是大于枢纽元的。递归的对左右两部分使用新的`枢纽元`进行划分，最终得到排序数组。

## 标准实现

标准的快速排序算法见《算法4》p182, p184。

### 实现细节

实际编程中，一般会以下技巧：

- 使用小数组优化
- 采取三取样切分
- 与切分元相等的元素会被交换

三取样切分用于避免面对近乎有序的数据，如果采用固定的pivot（如每次选择最左边的元素），会退化为 $O(N^2)$ 算法，此时递归树退化为链表。

在面对较多重复的数据时，如果只交换小于或大于枢纽元的数据，会退化为 $O(N^2)$ 算法，交换与切分元相等的元素可以避免这一点。

## 快速排序的特点

**枢纽元的选取很重要**

合理的枢纽元使得左右分布均匀，使得算法的时间复杂度为 $O(NlogN)$。

**平均情况下，快速排序使用较少的数据交换/移动**

在平均情况下，相比于归并排序算法，快速排序算法虽然比较次数更多，但交换/移动次数较少，这是它实际情况下性能表现优异的主要因素。

## 性能

快速排序最差情况下的时间复杂度为 $O(N^2)$，平均情况下的时间复杂度为 $O(NlogN)$ 。

## 变种实现

不同的算法书可能会介绍不同的快速排序变种，从一个学习者的角度来看，个人认为不必沉溺于这些变种，记不住它们是正常的。

### 三路划分的快速排序（《算法4》）

实际可能会遇到存在大量重复元素的情况，对标准快速排序而言，如果不交换与分割元素重复的元素，切分将趋向于不均匀，导致算法运行时间退化为 $O(N^2)$。

对重复元素进行交换是一种优化方案，另一种方案是将数据切分为三部分，称为三路划分的快速排序：

![三路划分的快速排序](_images/20200825173944152_12689.png)

代码见 《算法4》p189。

# 参考资料

《算法4》2.3 快速排序 p182